    if ($ssl_protocol = "") {
        rewrite ^   https://front2-nfe.lpa.opg.digital$request_uri? permanent;
    }
    if ($http_host = "lastingpowerofattorney.service.gov.uk") {
                 rewrite ^ https://www.lastingpowerofattorney.service.gov.uk$request_uri permanent;
    }

    # serve static files directly
    location ~ "^/assets/([0-9]+)" {

        access_log off;

        if ($uri ~* ^.+.(jpg|jpeg|gif|css|png|js|ico|htm|html|xml|txt|woff|eot|ttf)$ ){
            expires           24h;
        }

        rewrite	^/assets/([0-9]+)/(.*) /assets/$2  break;

    }

    location /static/ {
       proxy_pass https://localhost/static/;
    }

    location ~ \.php$ {

        satisfy any;
        set $realm on;
        if ( $http_x_real_ip ~ "^10\." ) {
          set $realm off;
        }

        if ( $http_x_forwarded_for = "" ) {
          set $realm off;
        }

        if ( $http_x_forwarded_for ~ "^10\." ) {
          set $realm off;
        }

        auth_basic         $realm;
        auth_basic_user_file  /etc/nginx/htpasswd-opg-lpa-front2;

        fastcgi_index   index.php;
        fastcgi_pass    127.0.0.1:9000;

        include         fastcgi_params;
        fastcgi_param   SCRIPT_FILENAME    $document_root$fastcgi_script_name;
        fastcgi_param   SCRIPT_NAME        $fastcgi_script_name;

        fastcgi_param   APPLICATION_ENV production;
    }

