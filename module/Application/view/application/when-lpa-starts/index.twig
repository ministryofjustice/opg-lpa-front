{% extends 'layout/twig/accordion-header.twig' %}

{% block content %}

{% import "application/macros.twig" as macros %}

{# Error messages #}
{% set form = formErrorTextExchange(form,  {
    'when' : {
        "Value is required and can't be empty" : 'Please choose when your LPA can be used',
    }
}) %}
  
{# Set form fields variables #}  
{% set when = form.get('when') %}
        
<li id="when-lpa-starts-section" class="section current js-current">
	
	<h2 class="heading-medium accordion-header flush--top">When can your LPA be used?</h2>
	
    <div class="accordion-info">
		<div class="text">
			<p>If you want help straight away with certain decisions about your property and financial affairs you can say that your LPA can be used as soon as it's registered.</p>
			<p>As long as you have mental capacity your registered LPA can only be used with your consent. You decide how and when it is used. Your attorneys will also be able to use your LPA fully if you don’t have mental capacity in the future.</p>
			<p>Alternatively, you can say that your LPA can only be used if you don’t have mental capacity.</p>
			<p><a href="/help/#topic-when-an-lpa-can-be-used" class="js-guidance" data-journey-click="stageprompt.lpa:help:when-an-lpa-can-be-used">Find out more about your options</a></p>
		</div>
	</div>

	{# begin form #}
	{{ form.prepare() ? '' }}
	{{ form().openTag( form )|raw }}
		{{ formElement(form.get( form.csrfName )) }}

		{{ macros.formErrorSummary(error,form,'There was a problem submitting the form') }}

		<fieldset>
			<legend class="visuallyhidden">When can your LPA be used?</legend>

			<h2 class="heading-medium flush--top">My LPA can be used</h2>

		    <div class="form-group {{ when.getMessages|length > 0 ? 'error'}}">
		        {{ formRadio(when) }}
		        {{ formElementErrorsV2(when) }}
		    </div>
		</fieldset>

		<div class="form-group">
			<input type="submit" name="save" value="Save and continue" class="button">
		</div>

	{{ form().closeTag|raw }}
    
</li>

{% endblock %}