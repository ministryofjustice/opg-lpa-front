{% extends 'layout/twig/layout.twig' %}

{% block pageTitle %}
    Send us feedback
{% endblock %}

{% set type = form.get('rating').setOptions({ label: 'Rate your experience' }) %}

{% block errorSummary %}
    {% include 'application/feedback/partials/index-error-summary.twig' %}
{% endblock %}

{% block content %}

{% import "application/macros.twig" as macros %}

{{ form.setAttribute('class', 'form') ? '' }}

{% set type = form.get('rating') %}
{% set details = form.get('details') %}
{% set email = form.get('email') %}
{% set phone = form.get('phone') %}

{{ details.setAttributes({
    id: 'details',
    rows: 10,
    cols: 67,
    maxlength: 2000,
    class: 'form-control'
}) ? ''}}

{{ email.setAttributes({
    id: 'email',
    type: 'email',
    maxlength: 100,
    class: 'form-control'
}) ? ''}}

{{ phone.setAttributes({
    id: 'phone',
    type: 'phone',
    maxlength: 15,
    class: 'form-control'
}) ? ''}}

{% set allOptions = type.getOptions() %}
{% set typeValueOptions = allOptions['value_options'] %}

{{ type.setOptions({
    label_attributes: {'class': 'block-label'}
}) ? ''}}

{{ form().openTag( form )|raw }}

    {{ formElement(form.get( form.csrfName )) }}

    <h2 class="heading-medium flush--top">How would you rate your experience with this service?</h2>

    <fieldset>
        <legend class="group text">
        </legend>

        <div class="form-group {{ type.getMessages|length >0 ? 'error'}}">
            {{ formElementErrorsV2(type) }}
            {{ formElement(type) }}
        </div>
    </fieldset>

    <h2 class="heading-medium text">Please take a moment to tell us about your experience, what worked and what didn't.</h2>

    <fieldset>
        <legend class="group text">
        </legend>
        <div class="form-group {{ details.getMessages|length >0 ? 'error'}}">
            <label class="form-label text" for="{{ details.getAttribute('id') }}">
                <span class="visuallyhidden">Your feedback<br></span>
                <span class="form-hint">2000 characters max<br></span>
                {{ formElementErrorsV2(details) }}
            </label>
            {{ formElement(details) }}
        </div>
    </fieldset>

    <div class="text">
        <p>We won't respond to your feedback directly but use it to improve this service. If you are happy to be contacted to give further feedback, please leave your email address and/or phone number.</p>
        <p>If you have a query you need us to answer, email <a href="mailto:customerservices@publicguardian.gsi.gov.uk">customerservices@publicguardian.gsi.gov.uk</a></p>
    </div>

    <h2 class="heading-medium flush--top">Your email address (optional)</h2>

    <fieldset>
        <legend class="group text">
        </legend>

        {{ macros.formGroup(email) }}

    </fieldset>

    <h2 class="heading-medium flush--top">Your phone number (optional)</h2>
 
    <fieldset>
        <legend class="group text">
        </legend>
        <div class="form-group {{ phone.getMessages|length >0 ? 'error'}}">
            <label class="form-label text" for="{{ phone.getAttribute('id') }}">
                <span class="visuallyhidden">Your phone number (optional)</span>
                {{ formElementErrorsV2(phone) }}
            </label>
            {{ formElement(phone) }}
        </div>
    </fieldset>
    
    <input type="submit" name="send" id="send" class="button" value="Send feedback">

{{ form().closeTag|raw }}

{% endblock content %}
            
            
